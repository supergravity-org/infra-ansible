# this file is generated by ansible. DO NOT EDIT
FROM istepanov/dokuwiki
MAINTAINER Ilya Stepanov <dev@ilyastepanov.com>

# this is an example Dockerfile that demonstrates how to add Dokuwiki plugins to istepanov/dokuwiki image

RUN apt-get update && \
    apt-get install -y unzip {% for pl in dokuwiki_plugins.values() %}{% if 'install' in pl %}{{ pl.install|join(' ')}} {% endif %}{% endfor %} && \
    apt-get clean && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*

RUN mkdir -p /plugins

# add todo plugin
#RUN curl -O -L "https://github.com/leibler/dokuwiki-plugin-todo/archive/stable.zip" && \
#    unzip stable.zip -d /var/www/lib/plugins/ && \
#    mv /var/www/lib/plugins/dokuwiki-plugin-todo-stable /var/www/lib/plugins/todo && \
#    rm -rf stable.zip
{% for name, plugin in dokuwiki_plugins.items() %}
# plugin: {{ name }}
RUN curl -L "{{plugin.url}}" -o /plugins/{{name}}.zip && \
    unzip -o /plugins/{{name}}.zip -d /var/www/lib/plugins/ {% if 'move' in plugin %} && \
    mv /var/www/lib/plugins/{{plugin.move.0}} /var/www/lib/plugins/{{plugin.move.1}} {% endif %}

{% endfor %}
